<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Dynamic creation of DOM components and subcomponents</title>
	
	<script src="/SkFramework/utils/harmony-collections.js" type="text/javascript"></script>
	<style>
		.dgrid-header {
			font-size: 36px;
		}
	</style>
</head>
<body>
    <script data-dojo-config="async: true, isDebug: true" src="/dojo/dojo.js"></script>
    <script>
		require([
			'dojo/_base/declare',	'dojo/on',
			'SkFramework/component/DomComponent',
			'SkFramework/component/_WithDijit',	'SkFramework/component/_WithDomNode',
			'put-selector/put',
			'dgrid/Grid',
			'dojo/domReady!'
		], function(
			declare,				on,
			DomComponent,
			WithDijit,							WithDom,
			put,
			Grid
		) {
			var Component = declare([DomComponent, WithDijit, WithDom]);
			window.main = new Component();
			main._addComponents({
				displayTitleBtn: put('button', "Place/unplace title"),
				registerTitleBtn: put('button', "Add/remove title"),
				grid: Grid({ columns: ['Title'] }),
				displayGridBtn: put('button', "Place/unplace grid")
			});
			main._components.grid.renderArray(["Row 1", "Row 2"]);
			
			var gridDisplayed = true;
			on(main._components.displayGridBtn, 'click', function() {
				if (gridDisplayed) {
					main._unplaceComponent('grid');
				} else {
					main._placeComponent('grid');
				}
				gridDisplayed = !gridDisplayed;
			});
			var titleDisplayed = false;
			on(main._components.displayTitleBtn, 'click', function() {
				if (titleDisplayed) {
					main._unplaceComponent('title');
				} else {
					main._placeComponent('title', 'first');
				}
				titleDisplayed = !titleDisplayed;
			});
			var titleRegistered = false;
			on(main._components.registerTitleBtn, 'click', function() {
				if (titleRegistered) {
					main._removeComponent('title');
				} else {
					main._addComponents({
						title: put('h1', "Test")
					});
				}
				titleRegistered = !titleRegistered;
			});
			
			main._placeComponents([
				'registerTitleBtn',
				'displayTitleBtn',
				'displayGridBtn',
				'grid'
			]);
			
			document.body.appendChild(main.render());
			main.set('inDom');
		});
	</script>
</body>
</html>